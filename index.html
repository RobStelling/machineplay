<!-- Copyright 2017 Google Inc. All Rights Reserved.
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
==============================================================================
-->

<!doctype html>



<!doctype html>
<meta charset="utf-8">
<head>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <script src="https://distill.pub/template.v1.js"></script>
  <script type="text/front-matter">
    title: "MA - Your mileage may vary"
    description: "Explaining machine learning concepts through an interactive application"
    authors:
    - Roberto Stelling: http://stelling.cc/
    - Adriana Vivacqua: http://www.im.ufrj.br/visualizarDocente.php?idDepartamento=2&idDocente=147
    affiliations:
    - PPGI/UFRJ: http://www.ppgi.ufrj.br/
    - PPGI/UFRJ: http://www.ppgi.ufrj.br/
  </script>

  <dt-article>
    <h1>ML - Your mileage may vary</h1>
    <h2>Explaining machine learning concepts through an interactive application<dt-fn>Or "Why my results are different?"</dt-fn></h2>
    <dt-byline></dt-byline>
    <p><h1 id="TLDR">TL;DR</h1></p>
    <p>There are lots of myths about machine learning but we believe that the best way to understand machine learning concepts is by playing with real, or quasi real, machine learning applications. We've build an interactive web application where you can train a deep learning model, change its parameters, see it converge (or not!), start over and play as much as you want with the different parameters. Hopefully you will develop some insights about machine learning after playing with the application. By the way, the parameters are a bit off to start with, so it is up to you to improve them! Before you delve into the demo, notice that the algorithm is trying to predict the complementary colors of a given color. There is an explanation of the visuals <em>here</em>, but we are sure you will bet able to get it as you play. <a href="#MLPlay">Let's play</a></p>
    <h2>The not so long road...</h2>
    <p>On a conversation with a longtime friend a couple of months ago I had to answer the perennial question: "What are you doing these days?". This wouldn't be much of a conversation topic a few years back, when I was deeply entrenched in the Enterprise Content Management industry. My friend would shrug and the conversation would move on to another, hopefully interesting, topic. But these days, I'm doing Data Visualization in Machine Learning. More specifically, visual explanations for deep learning neural networks. To my friend this was a mouthful, but an interesting one.
    </p>
    <p>It struck me, during this conversation, that my friend didn't really understood what machine learning is about. There is a large spectrum of myths surrounding artificial intelligence, some stemming from news about its most recent achievements, but a good fraction of these myths come almost verbatim from the pages of Clifford Simak <dt-cite key="simak1977skirmish"></dt-cite> and Mary Shelley <dt-cite key="shelley2009frankenstein"></dt-cite>, or worse, from the movie pictures based on Mary Shelley's classic story.</p>
    <p>We found out that a common difficulty in understanding machine learning applications arise from a simple misconception about the very framework of a machine learning application. Most people look at the field through the lenses of a traditional application, where data is fed to an algorithm that produces an answer.</p>
    <p><img src="DataAlgorithmAnswer.png"></p>
    <p>To grok machine learning applications you must understand how machine learning applications <em>come to life</em> in the first place: you feed a <b>BIG</b> amount of data to a Machine Learning Training algorithm and it produces an algorithm for you. The result is the very algorithm that will later take data a produce an answer for you.</p>
    <p><img src="DataMLAlgorithm.png"></p>
    <p>We realized that explaining neural networks with the concept of the McCulloch/Pitts <dt-cite key="mcculloch1943logical"></dt-cite> neuron would lead us directly to the <a href="#TLDR">TL;DR highway</a>.</p>
    <p>But then again, what is Machine Learning <em>Training</em>? Training is a method of using the existing data to produce answers to the problem we are working with. Suppose that you are at the bottom of an empty pool.</p>
    <p><img src="pool.jpg"></p>
    <p>The pool above has water in it, but you got the gist of it. Now, suppose that each tile of the pool is connected to another tile, but you don't know how the tiles are connected! At this juncture, if someone asks you what tile is connected to tile <b><em>X</em></b>, for example, the best you can do is move around randomly in the pool and stop over a particular <b><em>Y</em></b> tile. As you are an algorithm with a bit of responsability, if someone asks you again about the same <b><em>X</em></b> tile, you will produce the same <b><em>Y</em></b> answer. For every tile in the pool, you can walk to another corresponding tile but, as you are a machine learning algorithm without training, you will produce bogus answers, but answers you will produce!</p>
    <p>Now suppose that you are given set of <b><em>n</em></b> tiles pairs. You can then use these pairs to correct your routes. You try every one of the tiles you've got and you will adjust all your routes at the same time (you cannot change just one route, any change you make affect all your routes!), trying to minimize the error in the tile pairs youve got. The idea is that if you can make a correct guess on the tiles you saw, there is a chance that you will be able to make a correct guess on the tiles you never saw! Now, you can adjust the routes in baby steps, changing the routes just a little bit, while trying to improve the routes you know are right, or you can adjust the routs in big steps, changing your routes a lot, or you can do something in between these two extremes. Now, when will you stop training? Maybe you will stop after training for 1.000 rounds, or you will stop when the error in the routes you got is smaller then a certain value.</p>
    <p>If you are still following us, then you, hopefully, understood what were you doing inside the pool. We can now throw a bit of nomenclature:</p>
    <ul>
      <li><b>Learning Rate</b>: Is the amount of change you make on each pass. Big changes correspond to high learning rate, small changes correspond to small learning rate. If the learning rate is too big, you may never be able to correct the routes. If the learning rate is too small, it may take very long to properly correct the routes.</li>
      <li><b>Batch Size</b>: Is the amount of tiles pairs you get at each turn. The bigger the batch size, the better your adjustmens, but you will take longer to process them. Remember, though, that you can process the tiles in parallel, so a small batch size can be a bad thing.</li>
      <li><b>Step Limit</b>: Is the maximum amount of rounds of training that you will go through.</li>
      <li><b>Cost Limit</b>: Is the minimum error that your routes must have in order to stop the training.</li>
    </ul>
    <p>There are another concepts in neural network training, but the for above are the ones you will see at work in the interactive application.
    <center><img src="MPStart.png" width="50%" height="50%"></center>
    <dt-code block language="javascript">
      var x = 25;
      function(x){
        return x * x;
      }
    </dt-code>
    
    <p>We can also cite <dt-cite key="gregor2015draw"></dt-cite> external publications.</p>
    <p><a href="#MLPlay">Let's play</a></p>
  </dt-article>

  <dt-appendix>
    <h3>Apendix</h3>
        <dt-code block language="javascript">
      var x = 25;
      function(x){
        return x * x;
      }
    </dt-code>
  </dt-appendix>

  <script type="text/bibliography">
    @article{gregor2015draw,
      title={DRAW: A recurrent neural network for image generation},
      author={Gregor, Karol and Danihelka, Ivo and Graves, Alex and Rezende, Danilo Jimenez and Wierstra, Daan},
      journal={arXivreprint arXiv:1502.04623},
      year={2015},
      url={https://arxiv.org/pdf/1502.04623.pdf}
    }
    @book{shelley2009frankenstein,
      title={Frankenstein, or, The Modern Prometheus, 1818},
      author={Shelley, Mary Wollstonecraft},
      year={2009},
      publisher={Engage Books, AD Classic}
    }
    @article{mcculloch1943logical,
      title={A logical calculus of the ideas immanent in nervous activity},
      author={McCulloch, Warren S and Pitts, Walter},
      journal={The bulletin of mathematical biophysics},
      volume={5},
      number={4},
      pages={115--133},
      year={1943},
      publisher={Springer}
    }
    @book{simak1977skirmish,
      title={Skirmish: The Great Short Fiction of Clifford D. Simak},
      author={Simak, Clifford D},
      year={1977},
      publisher={Putnam}
    }
  </script>
  <div style="overflow-x:auto;" id="MLPlay">
    <table>
      <tr>
        <th id="startStop">Start</th>
        <th>Reset</th>
        <th>Learning Rate</th>
        <th>Batch Size</th>
        <th>Render interval</th>
        <th>Step Limit</th>
        <th>Cost Target</th>
      </tr>
      <tr>
        <td>
          <label class="switch">
            <input id="trigger" type="checkbox">
            <span class="slider round trigger"></span>
          </label>
        </td>
        <td>
          <label class="switch">
            <input id="update" type="checkbox" checked disabled>
            <span class="slider round"></span>
          </label>
        </td>
        <td>
          <div class="""slidecontainer">
            <input type="range" min="0.001" max="0.759" value="0.001" step="0.001" class="rangeslider freeze" id="learning_range">
            <span id="learning_val"></span>
          </div>
        </td>
        <td>
          <div class="""slidecontainer">
            <input type="range" min="1" max="128" value="1" class="rangeslider freeze" id="batch_range">
            <span id="batch_val"></span>
          </div>
        </td>
        <td>
          <div class="""slidecontainer">
            <input type="range" min="1" max="50" value="1" class="rangeslider" id="render_range">
            <span id="render_val"></span>
          </div>
        </td>
        <td>
          <div class="""slidecontainer">
            <input type="range" min="25" max="10000" value="25" class="rangeslider" id="step_range">
            <span id="step_val"></span>
          </div>
        </td>
        <td>
          <div class="""slidecontainer">
            <input type="range" min="0.00005" max="0.001" value="0.00005" step="0.00001" class="rangeslider" id="cost_range">
            <span id="cost_val"></span>
          </div>
        </td>
      </tr>
    </table>
  </div>


  <svg id="DLCCP" viewBox="-600 -600 1200 1200" width="100%" height="100%"></svg>
  <table id='color-table' border='0' style='display:none'>
    <tr>
      <th>Original Color</th>
      <th>Actual Complement</th>
      <th>Predicted Complement</th>
    </tr>
    <tr data-original-color='244,67,54'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='233,30,99'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='156,39,176'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='103,58,183'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='63,81,181'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='33,150,243'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='76,175,80'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='139,195,74'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='205,220,57'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='255,235,59'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='255,193,7'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='255,152,0'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='255,87,34'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='121,85,72'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='158,158,158'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='96,125,139'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr data-original-color='0,0,0'>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </table>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.1.0/d3-annotation.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.12.0"></script>
  <script src='tf_ccp.js'></script>
</body>
